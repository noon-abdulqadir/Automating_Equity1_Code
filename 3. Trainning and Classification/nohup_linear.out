Using MPS
0it [00:00, ?it/s]0it [00:00, ?it/s]
Using MPS
Using MPS
Dataframe loaded with shape: (5947, 68)
########################################
Starting!
########################################
Searching for existing estimators in directory:
/Users/nyxinsane/Documents/Work - UvA/Automating Equity/Study 1/Study1_Code/data/classification models/Supervised Results/
  0%|          | 0/82 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 82/82 [00:00<00:00, 508776.52it/s]
  0%|          | 0/2 [00:00<?, ?it/s]--------------------
============================== TRAINING DATASET OF LENGTH 5947 ON WARMTH ==============================
--------------------
Vectorizers to be used (3):
['CountVectorizer', 'TfidfVectorizer', 'FeatureUnion']
Total number of vectorizer parameters = 6
Selectors to be used (1):
['SelectKBest']
Total number of selector parameters = 2
Resamplers to be used (1):
['SMOTETomek']
Total number of resamplers parameters = 2
classifiers to be used (6):
['LogisticRegression', 'SGDClassifier', 'PassiveAggressiveClassifier', 'Perceptron', 'MLPClassifier', 'GradientBoostingClassifier']
Total number of classifiers parameters = 34
Loading previous Xy.
++++++++++++++++++++++++++++++
========== Loading Xy from previous for Warmth ==========
++++++++++++++++++++++++++++++
Loading df_train_data from /Users/nyxinsane/Documents/Work - UvA/Automating Equity/Study 1/Study1_Code/data/classification models/df_train_data - Warmth - (Save_protocol=5).pkl
Loading df_test_data from /Users/nyxinsane/Documents/Work - UvA/Automating Equity/Study 1/Study1_Code/data/classification models/df_test_data - Warmth - (Save_protocol=5).pkl
Loading df_val_data from /Users/nyxinsane/Documents/Work - UvA/Automating Equity/Study 1/Study1_Code/data/classification models/df_val_data - Warmth - (Save_protocol=5).pkl
Done loading Xy from previous for Warmth!
Done splitting data into training and testing sets.
====================
Training set shape: (4446,)
----------
Training set example:
This internship is for you if:
~~~~~~~~~~
Testing set shape: (593,)
----------
Testing set example:
General switchboard number +44 (0)207 801 3380.
~~~~~~~~~~
Validation set shape: (889,)
----------
Validation set example:
Effective ability to prioritize tasks and deliver on deadlines, with high performance standards and a commitment to excellence.
~~~~~~~~~~
Training data class weights:
Ratio = 0.37 (0 = 0.68, 1 = 1.86)
----------
Testing data class weights:
Ratio = 0.39 (0 = 0.69, 1 = 1.79)
----------
Validation data class weights:
Ratio = 0.40 (0 = 0.70, 1 = 1.76)
====================
Done loading Xy from previous for Warmth!

  0%|          | 0/18 [00:00<?, ?it/s][A--------------------
Already trained Warmth - CountVectorizer + LogisticRegression
--------------------
--------------------
Already trained Warmth - CountVectorizer + SGDClassifier
--------------------
--------------------
Already trained Warmth - CountVectorizer + PassiveAggressiveClassifier
--------------------
--------------------
Already trained Warmth - CountVectorizer + Perceptron
--------------------
--------------------
Already trained Warmth - CountVectorizer + MLPClassifier
--------------------
--------------------
Already trained Warmth - CountVectorizer + GradientBoostingClassifier
--------------------
--------------------
Already trained Warmth - TfidfVectorizer + LogisticRegression
--------------------
--------------------
Already trained Warmth - TfidfVectorizer + SGDClassifier
--------------------
--------------------
Already trained Warmth - TfidfVectorizer + PassiveAggressiveClassifier
--------------------
--------------------
Already trained Warmth - TfidfVectorizer + Perceptron
--------------------
--------------------
Already trained Warmth - TfidfVectorizer + MLPClassifier
--------------------
--------------------
Already trained Warmth - TfidfVectorizer + GradientBoostingClassifier
--------------------
--------------------
Already trained Warmth - FeatureUnion + LogisticRegression
--------------------
--------------------
============================== Using GridSearchCV ==============================
--------------------
GridSearchCV with:
Pipe:
Pipeline(steps=[('FeatureUnion',
                 FeatureUnion(transformer_list=[('CountVectorizer',
                                                 CountVectorizer(max_df=0.85,
                                                                 min_df=0.15,
                                                                 ngram_range=(1,
                                                                              3))),
                                                ('TfidfVectorizer',
                                                 TfidfVectorizer(max_df=0.85,
                                                                 min_df=0.15,
                                                                 ngram_range=(1,
                                                                              3)))])),
                ('SelectKBest', SelectKBest()), ('SMOTETomek', SMOTETomek()),
                ('SGDClassifier', SGDClassifier())])
Params:
{'FeatureUnion__CountVectorizer__analyzer': ['word'], 'FeatureUnion__CountVectorizer__ngram_range': [(1, 3)], 'FeatureUnion__CountVectorizer__lowercase': [True, False], 'FeatureUnion__CountVectorizer__max_df': [0.85, 0.8, 0.75], 'FeatureUnion__CountVectorizer__min_df': [0.15, 0.2, 0.25], 'FeatureUnion__TfidfVectorizer__analyzer': ['word'], 'FeatureUnion__TfidfVectorizer__ngram_range': [(1, 3)], 'FeatureUnion__TfidfVectorizer__lowercase': [True, False], 'FeatureUnion__TfidfVectorizer__use_idf': [True, False], 'FeatureUnion__TfidfVectorizer__max_df': [0.85, 0.8, 0.75], 'FeatureUnion__TfidfVectorizer__min_df': [0.15, 0.2, 0.25], 'SelectKBest__score_func': [<function f_classif at 0x16cfa2ef0>, <function chi2 at 0x16cfa3010>, <function f_regression at 0x16cfa3130>], 'SelectKBest__k': ['all'], 'SGDClassifier__loss': ['squared_hinge'], 'SGDClassifier__random_state': [42], 'SGDClassifier__fit_intercept': [True, False], 'SGDClassifier__class_weight': ['balanced'], 'SGDClassifier__max_iter': [700000, 800000, 900000, 1000000, 1100000, 1200000, 1300000]}
++++++++++++++++++++++++++++++
Fitting GridSearchCV
n_iterations: 4
n_required_iterations: 10
n_possible_iterations: 4
min_resources_: 120
max_resources_: 5335
aggressive_elimination: False
factor: 3
----------
iter: 0
n_candidates: 27216
n_resources: 120
Fitting 30 folds for each of 27216 candidates, totalling 816480 fits
----------
iter: 1
n_candidates: 9072
n_resources: 360
Fitting 30 folds for each of 9072 candidates, totalling 272160 fits
